// Translations for the portfolio
const translations = {
  fr: {
    // Navigation
    nav_about: "À Propos",
    nav_projects: "Projets",
    nav_contact: "Contact",

    // Hero Section
    hero_greeting: "BONJOUR, JE M'APPELLE",
    hero_name: "Mohamed Melek Chtourou",
    hero_title: "Ingénieur en Génie Logiciel",
    hero_description:
      "Ingénieur FullStack passionné par la création d'expériences numériques innovantes. Découvrez mes projets et n'hésitez pas à me contacter pour collaborer.",
    hero_cta: "Voir mes projets",
    hero_contact: "Me contacter",
    hero_download_cv: "Télécharger le CV",
    hero_cv_glitch: "CV",
    hero_view_projects: "Voir mes projets",
    hero_projects_glitch: "PROJETS",
    hero_typing: [
      "Un Geek",
      "Un Ingénieur FullStack",
      "Un Artiste",
      "Un Gamer",
    ],

    // About Section
    about_title: "À PROPOS",
    about_subtitle: "Découvrez mon parcours et mes compétences",
    about_text:
      "Passionné par le développement web et mobile, je transforme des idées en solutions digitales élégantes et performantes. Avec une expertise en développement full-stack, je crée des applications qui combinent design moderne et fonctionnalité optimale.",

    // Skills Section
    skills_title: "COMPÉTENCES",
    skills_subtitle: "Technologies et outils que je maîtrise",

    // Projects Section
    projects_title: "MES PROJETS",
    projects_subtitle: "Découvrez une sélection de mes réalisations récentes",

    // Contact Section
    contact_title: "CONTACTEZ-MOI",
    contact_subtitle: "Vous avez un projet en tête ? Discutons-en !",
    contact_text:
      "Je suis toujours ouvert à de nouvelles opportunités et collaborations. N'hésitez pas à me contacter pour discuter de vos projets.",
    contact_cta: "M'envoyer un email",

    // Footer
    footer_rights: "Tous droits réservés.",

    // Project Pages Common
    project_summary: "Résumé",
    project_technologies: "Technologies",
    project_features: "Fonctionnalités clés",
    project_year: "Année",
    project_gallery: "Galerie",
    project_demo: "Démo",
    project_link: "Lien du site",

    // The Landlord
    thelandlord_title: "The Landlord",
    thelandlord_subtitle:
      "Plateforme moderne pour la gestion et la location immobilière — une solution complète pour propriétaires et locataires.",
    thelandlord_description:
      "The Landlord est une plateforme web destinée à simplifier la location et la gestion de biens immobiliers. Elle permet aux propriétaires de gérer leurs annonces et aux locataires de trouver un logement via des filtres avancés.",
    thelandlord_features: [
      "Recherche multi-critères (prix, localisation, type)",
      "Gestion d'annonces (création, modification, calendrier)",
      "Messagerie entre locataires et propriétaires",
      "Pages de biens avec galeries et infos détaillées",
    ],

    // Tesa
    tesa_title: "Tesa",
    tesa_subtitle:
      "Application mobile pour centraliser les résultats et contenus esportifs — recherche, vidéos, classements et profils joueurs.",
    tesa_description:
      "Tesa regroupe l'écosystème esport : résultats, vidéos et profils. Intégrations avec Challonge et Top Eighter pour centraliser les données de tournois.",
    tesa_features: [
      "Consulter résultats et classements",
      "Regarder vidéos de finales",
      "Recherche avancée de joueurs",
      "Synchronisation des tournois (Challonge / Top Eighter)",
    ],

    // Artisan d'Art
    artisandart_title: "Artisan d'Art",
    artisandart_subtitle:
      "Application mobile et tableau de bord web favorisant la mise en avant des artisans, la promotion de leurs créations et l'interaction avec une communauté internationale.",
    artisandart_description:
      "Artisan d'Art connecte les artisans et les passionnés autour d'un espace numérique où ils peuvent partager leurs œuvres, publier des articles et interagir avec un public global.",
    artisandart_features: [
      "Suivi et abonnement aux artisans",
      "Publication d'articles et d'événements",
      "Interface mobile et web intégrée",
      "Notifications et interactions communautaires",
    ],

    // Randev
    randev_title: "Randev",
    randev_subtitle:
      "Application mobile pour la gestion des rendez-vous entre clients et commerçants — interface intuitive, filtres avancés et suivi simplifié.",
    randev_description:
      "Randev simplifie la gestion des rendez-vous pour les professionnels et leurs clients. Les commerçants peuvent gérer leurs employés et suivre les réservations, tandis que les utilisateurs trouvent facilement un service via carte ou filtre.",
    randev_features: [
      "Recherche de commerces via carte et filtres",
      "Gestion des employés et rendez-vous",
      "Vue claire du planning des réservations",
      "Interface fluide pour client et propriétaire",
    ],

    // Esprit App
    esprit_title: "Esprit App",
    esprit_subtitle:
      "Application iOS développée pour les étudiants d'Esprit afin de centraliser les actualités, les événements, les contacts enseignants et la carte du campus.",
    esprit_description:
      "Esprit Mobile est une application iOS destinée aux étudiants d'Esprit. Elle permet de consulter les actualités et événements de l'école, d'accéder aux informations sur les enseignants et de s'orienter facilement grâce à une carte interactive du campus.",
    esprit_features: [
      "Actualités et événements de l'école",
      "Contacts enseignants et biographies",
      "Carte interactive du campus",
      "Interface claire et fluide sur iOS",
    ],

    // Lost & Found
    lostfound_title: "Lost & Found",
    lostfound_subtitle:
      "Une application mobile pour retrouver vos objets perdus ou signaler ceux trouvés. Disponible sur iOS, Android et Huawei AppGallery.",
    lostfound_description:
      "Lost & Found aide les utilisateurs à signaler et retrouver des objets perdus. L'app intègre un système de sécurité avec question secrète, et propose une fonctionnalité de don caritatif lorsque l'objet reste introuvable.",
    lostfound_features: [
      "Signalement d'objet perdu/trouvé",
      "Recherche filtrée et géolocalisation",
      "Question secrète de sécurité",
      "Option de don caritatif",
    ],
  },

  en: {
    // Navigation
    nav_about: "About",
    nav_projects: "Projects",
    nav_contact: "Contact",

    // Hero Section
    hero_greeting: "HELLO, MY NAME IS",
    hero_name: "Mohamed Melek Chtourou",
    hero_title: "Software Engineer",
    hero_description:
      "FullStack Engineer passionate about creating innovative digital experiences. Discover my projects and feel free to contact me to collaborate.",
    hero_cta: "View my projects",
    hero_contact: "Contact me",
    hero_download_cv: "Download CV",
    hero_cv_glitch: "CV",
    hero_view_projects: "View my projects",
    hero_projects_glitch: "PROJECTS",
    hero_typing: ["A Geek", "A FullStack Engineer", "An Artist", "A Gamer"],

    // About Section
    about_title: "ABOUT",
    about_subtitle: "Discover my background and skills",
    about_text:
      "Passionate about web and mobile development, I transform ideas into elegant and high-performance digital solutions. With expertise in full-stack development, I create applications that combine modern design and optimal functionality.",

    // Skills Section
    skills_title: "SKILLS",
    skills_subtitle: "Technologies and tools I master",

    // Projects Section
    projects_title: "MY PROJECTS",
    projects_subtitle: "Discover a selection of my recent achievements",

    // Contact Section
    contact_title: "CONTACT ME",
    contact_subtitle: "Have a project in mind? Let's discuss!",
    contact_text:
      "I am always open to new opportunities and collaborations. Feel free to contact me to discuss your projects.",
    contact_cta: "Send me an email",

    // Footer
    footer_rights: "All rights reserved.",

    // Project Pages Common
    project_summary: "Summary",
    project_technologies: "Technologies",
    project_features: "Key Features",
    project_year: "Year",
    project_gallery: "Gallery",
    project_demo: "Demo",
    project_link: "Website Link",

    // The Landlord
    thelandlord_title: "The Landlord",
    thelandlord_subtitle:
      "Modern platform for real estate management and rental — a complete solution for owners and tenants.",
    thelandlord_description:
      "The Landlord is a web platform designed to simplify real estate rental and management. It allows owners to manage their listings and tenants to find housing through advanced filters.",
    thelandlord_features: [
      "Multi-criteria search (price, location, type)",
      "Listing management (creation, modification, calendar)",
      "Messaging between tenants and owners",
      "Property pages with galleries and detailed info",
    ],

    // Tesa
    tesa_title: "Tesa",
    tesa_subtitle:
      "Mobile application to centralize esports results and content — search, videos, rankings and player profiles.",
    tesa_description:
      "Tesa brings together the esports ecosystem: results, videos and profiles. Integrations with Challonge and Top Eighter to centralize tournament data.",
    tesa_features: [
      "View results and rankings",
      "Watch final videos",
      "Advanced player search",
      "Tournament synchronization (Challonge / Top Eighter)",
    ],

    // Artisan d'Art
    artisandart_title: "Artisan d'Art",
    artisandart_subtitle:
      "Mobile application and web dashboard promoting craftsmen, showcasing their creations and interaction with an international community.",
    artisandart_description:
      "Artisan d'Art connects artisans and enthusiasts around a digital space where they can share their works, publish articles and interact with a global audience.",
    artisandart_features: [
      "Follow and subscribe to artisans",
      "Publish articles and events",
      "Integrated mobile and web interface",
      "Notifications and community interactions",
    ],

    // Randev
    randev_title: "Randev",
    randev_subtitle:
      "Mobile application for appointment management between clients and merchants — intuitive interface, advanced filters and simplified tracking.",
    randev_description:
      "Randev simplifies appointment management for professionals and their clients. Merchants can manage their employees and track reservations, while users easily find a service via map or filter.",
    randev_features: [
      "Business search via map and filters",
      "Employee and appointment management",
      "Clear view of reservation schedule",
      "Fluid interface for client and owner",
    ],

    // Esprit App
    esprit_title: "Esprit App",
    esprit_subtitle:
      "iOS application developed for Esprit students to centralize news, events, teacher contacts and campus map.",
    esprit_description:
      "Esprit Mobile is an iOS application for Esprit students. It allows consulting school news and events, accessing teacher information and navigating easily thanks to an interactive campus map.",
    esprit_features: [
      "School news and events",
      "Teacher contacts and biographies",
      "Interactive campus map",
      "Clear and fluid iOS interface",
    ],

    // Lost & Found
    lostfound_title: "Lost & Found",
    lostfound_subtitle:
      "A mobile application to find your lost items or report found ones. Available on iOS, Android and Huawei AppGallery.",
    lostfound_description:
      "Lost & Found helps users report and find lost items. The app integrates a security system with secret question, and offers a charitable donation feature when the item remains unfound.",
    lostfound_features: [
      "Lost/found item reporting",
      "Filtered search and geolocation",
      "Secret security question",
      "Charitable donation option",
    ],
  },
};

// Language manager
const LanguageManager = {
  currentLanguage: localStorage.getItem("language") || "fr",
  isInitialLoad: true,

  init() {
    this.updateLanguage(this.currentLanguage, false); // false = no animation on initial load
    this.setupLanguageSelector();
    this.isInitialLoad = false;
  },

  setupLanguageSelector() {
    const languageButtons = document.querySelectorAll("[data-language]");
    languageButtons.forEach((button) => {
      button.addEventListener("click", (e) => {
        e.preventDefault();
        const lang = button.getAttribute("data-language");
        this.updateLanguage(lang, true); // true = show animation when user clicks
      });
    });
  },

  updateLanguage(lang, showAnimation = true) {
    this.currentLanguage = lang;
    localStorage.setItem("language", lang);

    // Add glitch animation to all translatable elements
    const translatableElements = [
      ...document.querySelectorAll("[data-i18n]"),
      ...document.querySelectorAll("[data-i18n-list]"),
      ...document.querySelectorAll("[data-i18n-list] li"),
      ...document.querySelectorAll(".language-transition"),
      ...document.querySelectorAll(".project-card"),
      ...document.querySelectorAll(".tech-badge"),
      ...document.querySelectorAll(".profile-image-container"),
    ];

    // Only show animation if requested (not on initial load)
    if (showAnimation) {
      // Force-restart animations so they play on every language change
      translatableElements.forEach((element) => {
        element.classList.remove("glitching");
        element.style.animation = "none";
        // force reflow to reset animation state
        void element.offsetWidth;
        element.style.animation = "";
      });

      // Add glitching class to all elements
      translatableElements.forEach((element) => {
        element.classList.add("glitching");
      });
    }

    // Wait for animation to complete before updating text (or update immediately if no animation)
    setTimeout(
      () => {
        // Update all elements with data-i18n attribute
        document.querySelectorAll("[data-i18n]").forEach((element) => {
          const key = element.getAttribute("data-i18n");
          const translation = this.getTranslation(key);

          if (translation) {
            // Check if it's an input placeholder
            if (element.tagName === "INPUT" || element.tagName === "TEXTAREA") {
              element.placeholder = translation;
            } else {
              element.textContent = translation;
            }
          }
        });

        // Update list items with data-i18n-list
        document.querySelectorAll("[data-i18n-list]").forEach((list) => {
          const key = list.getAttribute("data-i18n-list");
          const translations = this.getTranslation(key);

          if (Array.isArray(translations)) {
            const items = list.querySelectorAll("li");
            translations.forEach((text, index) => {
              if (items[index]) {
                items[index].textContent = text;
              }
            });
          }
        });

        // Update typing animation content if available
        if (window.setTypingContent) {
          const typingContent = this.getTranslation("hero_typing");
          if (Array.isArray(typingContent)) {
            window.setTypingContent(typingContent);
          }
        }

        // Remove glitching class after animation (only if animation was shown)
        if (showAnimation) {
          setTimeout(() => {
            translatableElements.forEach((element) => {
              element.classList.remove("glitching");
            });
          }, 100);
        }
      },
      showAnimation ? 1600 : 0
    ); // Wait for animation only if showing it

    // Update active language indicator
    document.querySelectorAll("[data-language]").forEach((button) => {
      button.classList.remove("active");
    });
    document
      .querySelector(`[data-language="${lang}"]`)
      ?.classList.add("active");
  },

  getTranslation(key) {
    const keys = key.split(".");
    let value = translations[this.currentLanguage];

    for (const k of keys) {
      value = value?.[k];
    }

    return value;
  },
};

// Initialize on page load
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", () => {
    LanguageManager.init();
  });
} else {
  LanguageManager.init();
}

// Export for use in other scripts
window.LanguageManager = LanguageManager;
window.translations = translations;
